---
title: Send to Even Timer
description: A guide in my new Starlight docs site.
---

import { Code } from "@astrojs/starlight/components";

**Type:** Timer trigger.

**Auth Level:** FUNCTION.

**Description:** Sends requests to even via opengov every 30 seconds

<Code
  title="Send to Even Timer"
  lang="python"
  code={`
    @app.function_name(name="send_requests_timer")
    @app.schedule(schedule="*/30 * * * * *", arg_name="timer", run_on_startup=False)
    def send_requests_timer(timer: func.TimerRequest) -> None:
    `}
></Code>

## Expected input

---

This function does not recieve any input

## Expected return

---
The function returns success or failure, and updates the requests in the db accordingly

<Code
  title="Send to Even Timer response"
  lang="python"
  
  code={`
    try:
        # send request
        response = send_request_to_even(parsed_hospital_request)
        logger.info(f"response code {response.code}")

        if response.code == 200:
            # update send date if successful
            res = handle_successfull_response(db, request_id)
            logger.info(f"Request {request_id} sent {response.code}")
            return res
        else:
            # add to retry if unsuccessful
            retry_count = hospital_request.retryCounter
            res = handle_failed_response(db, request_id, retry_count)
            logger.info(f"Request {request_id} sent {response.code}")
            return res

    except Exception as e:
        logger.error(f"Error sending request to even: {e}")
        retry_count = hospital_request.retryCounter
        res = handle_failed_response(db, request_id, retry_count)
        logger.info(f"Request {request_id} failed due to server error")
        return None
    `}

/>

### Valid response

###### Body

return success with the request id and updates the request sent date

###### Status

200 OK

### Exception response

###### Body

returns failed sending request id and increase the request retry counter by 1

###### Status

response status code 
